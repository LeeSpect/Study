손실 함수의 아웃풋이 크다는 것은 손실이 크다는 것이니까 데이터에 잘 안 맞는 가설 함수라는 것이다.

반대로 손실 함수의 아웃풋이 작다는 것은 손실이 작다는 것이니까 데이터에 잘 맞는 가설 함수라는 것이다.

그렇다면 우리는 손실 함수의 아웃풋을 최소화해야 할 필요가 있다.

### 경사하강법이란.

손실 함수의 경사의 방향과 크기를 이용해서 족므씩 극소점을 향해 내려가는 방식이다.

![image](https://user-images.githubusercontent.com/64893709/115948963-5b9ae300-a50c-11eb-85da-1ff255a3998d.png)

위와 같은 3차원 그래프에서 특정 위치의 기울기(경사)를 구하기 위해서는 손실 함수 J를 각 인풋 변수에 대해서 편미분을 해야 한다.

편미분한 결과식에 현재 위치의 좌표를 대입하고, 이것을 벡터로 만들면 이것이 바로 이 위치에서의 기울기가 되는 것이다.

#### 이 기울기 벡터는 2가지 정보를 알려준다.

1번째는 이름 그대로 얼마나 기울어져 있는지 알려준다.   
2번째는 가장 가파르게 올라갈 수 있는 방향을 알려준다.

![image](https://user-images.githubusercontent.com/64893709/115949020-d7952b00-a50c-11eb-8e52-6946416db2d7.png)

그런데 우리는 위에서 알 수 있는 것처럼 극소점을 향해 가장 가파르게 내려가는 방향으로 가야 한다.

따라서 기울기 벡터에 마이너스를 붙인다.

![image](https://user-images.githubusercontent.com/64893709/115949054-1cb95d00-a50d-11eb-80de-2fb9e87daae3.png)

위 그림은 현재 위치가 세타0 = -3, 세타1 = -3, 기울기 벡터 = [2세타0, 4세타1] 이라고 가정한 그림이다.

기울기 벡터에 [-3, -3] 을 대입하면 기울기는 [-6, -12]가 나온다. 이 기울기를 이용해서 세타0과 세타1을 수정해주면 된다.

### 어떻게 수정해야 할까?

기울기 벡터의 원소 1은 세타0에 대해서 편미분을 한 것이고, 원소 2는 세타1에 대해서 편미분을 한 것이다.

그러면 세타0은 원소1을 이용해서 수정하고 세타1은 원소2를 이용해서 수정하면 된다.

![image](https://user-images.githubusercontent.com/64893709/115949118-9c472c00-a50d-11eb-8a99-0c378ba3f5a8.png)

현재 세타0에 기울기 벡터의 원소1을 더하면 가파르게 올라가는 거니까, 가파르게 내려가기 위해서 원소1을 빼면 된다.

그런데 그냥 빼는 것이 아니라 **학습률 알파**를 곱해서 뺀다.

**학습률 알파**는 경사를 타고 내려갈 때 얼마나 많이 움직일지 그 정도를 나타내는 수치이다.

할습률이 크면 한 번에 많이 움직이는 것이고, 학습률이 작으면 조금씩 움직이는 것이다.

지금은 학습률이 0.1이라고 가정한다.

![image](https://user-images.githubusercontent.com/64893709/115949245-a9184f80-a50e-11eb-9678-ab25be6461d4.png)

세타0과 세타1을 업데이트하면 -2.4와 -1.8으로 바뀐다.

위 과정들을 일반화해서 나타내면 다음과 같다.

![image](https://user-images.githubusercontent.com/64893709/115949360-92bec380-a50f-11eb-8074-9a6434c318ac.png)

손실 함수 J를 세타0에 대해서 편미분해서 나온 결괏값에 알파를 곱하고 그것을 세타0에서 뺀다.

그렇게 해서 나온 값이 새로운 세타0인 것이다. '세타0을 새롭게 업데이트했다.'라고도 표현한다.

세타1에 대해서도 같은 과정이 이루어진다. 다만, 세타1에서는 업데이트된 세타0이 아니라, 기존의 세타0을 넣어야 한다는 점에서 주의가 필요하다.
